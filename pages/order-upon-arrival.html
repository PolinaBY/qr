<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Requested Services</title>
    <link rel="stylesheet" href="../style.css">
    <!-- Добавляем EmailJS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
        // Инициализация EmailJS
        (function() {
            emailjs.init("5taBVN-c3p3SoTNfe");
        })();
    </script>
</head>
<body>
     <header>
        <a href="main.html" class="back-btn">← Back to main</a>
        <div class="logo">
            <img src="../изображение/logo.png" alt="Logo">
        </div>
        <h1>REQUESTED SERVICES</h1>
    </header>

    <div class="user-info-bar" id="userInfoBar">
        <div class="user-info-item"><strong>Name:</strong> <span id="info-name"></span></div>
        <div class="user-info-item"><strong>Phone:</strong> <span id="info-phone"></span></div>
        <div class="user-info-item"><strong>Flight:</strong> <span id="info-flight"></span></div>
    </div>
    <form id="servicesForm">
        <div class="services-container">
            <div class="service-section">
                <h1>REQUESTED SERVICES UPON ARRIVAL</h1>
                <!-- Service 1 -->
                <div class="service-item">
                    <div class="service-header">
                        <input type="checkbox" id="arrival-fuel-checkbox" class="service-checkbox">
                        <label for="arrival-fuel-checkbox" class="service-title">FUELING</label>
                    </div>
                    <div class="service-content">
                        <div class="form-group">
                            <label for="fuel-quantity">QUANTITY (liters)</label>
                            <input type="number" id="fuel-quantity" name="arrival_fuel_quantity" placeholder="Enter quantity" min="0" step="1">
                        </div>
                        <div class="form-group">
                            <label for="fuel-comment">COMMENT</label>
                            <textarea id="fuel-comment" name="arrival_fuel_comment" placeholder="Additional information"></textarea>
                        </div>
                    </div>
                </div>
                
        <!-- Service 2 -->
         <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-water-checkbox" class="service-checkbox">
                <label for="arrival-water-checkbox" class="service-title">POTABLE WATER SERVICE</label>
            </div>
            <div class="service-content">
                <div class="checkbox-group">
                    <input type="checkbox" id="water-drain" name="water-drain">
                    <label for="water-drain">DRAIN</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="arrival-water-fill" name="arrival-water-fill">
                    <label for="arrival-water-fill">FILL</label>
                </div>
                <div class="form-group" id="arrival-water-quantity-group" style="display: none;">
                    <label for="water-quantity">QUANTITY (liters)</label>
                    <input type="number" id="arrival-water-quantity" name="arrival-water-quantity" placeholder="Enter quantity" min="0" step="1">
                </div>
                <div class="form-group">
                    <label for="water-comment">COMMENT</label>
                    <textarea id="water-comment" name="water-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 3 -->
         <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-lavatory-checkbox" class="service-checkbox">
                <label for="arrival-lavatory-checkbox" class="service-title">LAVATORY SERVICE</label>
            </div>
            <div class="service-content">
                <div class="checkbox-group">
                    <input type="checkbox" id="lavatory-drain" name="lavatory-drain">
                    <label for="lavatory-drain">DRAIN & FLUSH</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="arrival-lavatory-fill" name="arrival-lavatory-fill">
                    <label for="arrival-lavatory-fill">FILL</label>
                </div>
                <div class="form-group" id="arrival-lavatory-quantity-group" style="display: none;">
                    <label for="lavatory-quantity">QUANTITY (liters)</label>
                    <input type="number" id="arrival-lavatory-quantity" name="arrival-lavatory-quantity" placeholder="Enter quantity" min="0" step="1">
                </div>
                <div class="form-group">
                    <label for="lavatory-comment">COMMENT</label>
                    <textarea id="lavatory-comment" name="lavatory-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 4 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-catering-checkbox" class="service-checkbox">
                <label for="arrival-catering-checkbox" class="service-title">CATERING SERVICE</label>
            </div>
            <div class="service-content">
                <div class="checkbox-group">
                    <input type="checkbox" id="catering-pickup">
                    <label for="catering-pickup">PICK UP DISHES & LAUNDRY</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="catering-handover">
                    <label for="catering-handover">HAND OVER FOOD FOR STORAGE</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="catering-bring">
                    <label for="catering-bring">BRING THE ORDER</label>
                </div>
                <div class="form-group">
                    <label for="catering-comment">COMMENT</label>
                    <textarea id="catering-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 5 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-garbage-checkbox" class="service-checkbox">
                <label for="arrival-garbage-checkbox" class="service-title">GARBAGE REMOVAL</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="garbage-comment">COMMENT</label>
                    <textarea id="garbage-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 6 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-documents-checkbox" class="service-checkbox">
                <label for="arrival-documents-checkbox" class="service-title">DOCUMENTS PRINTING</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label>LOAD FILES</label>
                    <div class="file-upload">
                        <input type="file" id="arrival-document-files" name="arrival-document-files" multiple>
                        <label for="arrival-document-files" class="file-upload-label">SELECT FILES</label>
                        <span class="file-name" id="arrival-document-files-name">No files selected</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="arrival-document-comment">COMMENT</label>
                    <textarea id="arrival-document-comment" name="arrival-document-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 7 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-storage-checkbox" class="service-checkbox">
                <label for="arrival-storage-checkbox" class="service-title">AIRCRAFT STORAGE IN HANGAR</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="storage-comment">COMMENT</label>
                    <textarea id="storage-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 8 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-gpu-checkbox" class="service-checkbox">
                <label for="arrival-gpu-checkbox" class="service-title">PROVIDE A GPU</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="gpu-comment">COMMENT</label>
                    <textarea id="gpu-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 9 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-acu-checkbox" class="service-checkbox">
                <label for="arrival-acu-checkbox" class="service-title">PROVIDE AN ACU</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="acu-comment">COMMENT</label>
                    <textarea id="acu-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 10 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-stepladder-checkbox" class="service-checkbox">
                <label for="arrival-stepladder-checkbox" class="service-title">PROVIDE A STEPLADDER</label>
            </div>
            <div class="service-content">
                <div class="checkbox-group">
                    <input type="checkbox" id="arrival-stepladder-above">
                    <label for="arrival-stepladder-above">ABOVE 1.5 m.</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="stepladder-below">
                    <label for="stepladder-below">BELOW 1.5 m.</label>
                </div>
                <div class="form-group">
                    <label for="stepladder-comment">COMMENT</label>
                    <textarea id="stepladder-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 11 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="arrival-other-checkbox" class="service-checkbox">
                <label for="arrival-other-checkbox" class="service-title">OTHER</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="other-comment">COMMENT</label>
                    <textarea id="other-comment" placeholder="Describe your request"></textarea>
                </div>
            </div>
        </div>

        <h1>REQUESTED SERVICES FOR DEPARTURE</h1>
        <!-- Service 1 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-fuel-checkbox" class="service-checkbox">
                <label for="departure-fuel-checkbox" class="service-title">FUELING</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="fuel-quantity">QUANTITY (liters)</label>
                    <input type="number" id="fuel-quantity" placeholder="Enter quantity" min="0" step="1">
                    <div class="error-message" id="fuel-quantity-error">Please enter a valid quantity</div>
                </div>
                <div class="form-group">
                    <label for="fuel-comment">COMMENT</label>
                    <textarea id="fuel-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 2 -->
         <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-water-checkbox" class="service-checkbox">
                <label for="departure-water-checkbox" class="service-title">POTABLE WATER SERVICE</label>
            </div>
            <div class="service-content">
                <div class="checkbox-group">
                    <input type="checkbox" id="water-drain" name="water-drain">
                    <label for="water-drain">DRAIN</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="departure-water-fill" name="departure-water-fill">
                    <label for="departure-water-fill">FILL</label>
                </div>
                <div class="form-group" id="departure-water-quantity-group" style="display: none;">
                    <label for="water-quantity">QUANTITY (liters)</label>
                    <input type="number" id="departure-water-quantity" name="departure-water-quantity" placeholder="Enter quantity" min="0" step="1">
                </div>
                <div class="form-group">
                    <label for="water-comment">COMMENT</label>
                    <textarea id="water-comment" name="water-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>


        <!-- Service 3 -->
         <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-lavatory-checkbox" class="service-checkbox">
                <label for="departure-lavatory-checkbox" class="service-title">LAVATORY SERVICE</label>
            </div>
            <div class="service-content">
                <div class="checkbox-group">
                    <input type="checkbox" id="lavatory-drain" name="lavatory-drain">
                    <label for="lavatory-drain">DRAIN & FLUSH</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="departure-lavatory-fill" name="departure-lavatory-fill">
                    <label for="departure-lavatory-fill">FILL</label>
                </div>
                <div class="form-group" id="departure-lavatory-quantity-group" style="display: none;">
                    <label for="lavatory-quantity">QUANTITY (liters)</label>
                    <input type="number" id="departure-lavatory-quantity" name="departure-lavatory-quantity" placeholder="Enter quantity" min="0" step="1">
                </div>
                <div class="form-group">
                    <label for="lavatory-comment">COMMENT</label>
                    <textarea id="lavatory-comment" name="lavatory-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 4 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-catering-checkbox" class="service-checkbox">
                <label for="departure-catering-checkbox" class="service-title">CATERING SERVICE</label>
            </div>
            <div class="service-content">
                <div class="checkbox-group">
                    <input type="checkbox" id="catering-pickup">
                    <label for="catering-pickup">PICK UP DISHES & LAUNDRY</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="catering-handover">
                    <label for="catering-handover">HAND OVER FOOD FOR STORAGE</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="catering-bring">
                    <label for="catering-bring">BRING THE ORDER</label>
                </div>
                <div class="form-group">
                    <label for="catering-comment">COMMENT</label>
                    <textarea id="catering-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 5 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-garbage-checkbox" class="service-checkbox">
                <label for="departure-garbage-checkbox" class="service-title">GARBAGE REMOVAL</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="garbage-comment">COMMENT</label>
                    <textarea id="garbage-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

       <!-- Service 6 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-documents-checkbox" class="service-checkbox">
                <label for="departure-documents-checkbox" class="service-title">DOCUMENTS PRINTING</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label>LOAD FILES</label>
                    <div class="file-upload">
                        <input type="file" id="departure-document-files" name="departure-document-files" multiple>
                        <label for="departure-document-files" class="file-upload-label">SELECT FILES</label>
                        <span class="file-name" id="departure-document-files-name">No files selected</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="departure-document-comment">COMMENT</label>
                    <textarea id="departure-document-comment" name="departure-document-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>


        <!-- Service 7 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-storage-checkbox" class="service-checkbox">
                <label for="departure-storage-checkbox" class="service-title">AIRCRAFT STORAGE IN HANGAR</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="storage-comment">COMMENT</label>
                    <textarea id="storage-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 8 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-gpu-checkbox" class="service-checkbox">
                <label for="departure-gpu-checkbox" class="service-title">PROVIDE A GPU</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="gpu-comment">COMMENT</label>
                    <textarea id="gpu-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 9 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-acu-checkbox" class="service-checkbox">
                <label for="departure-acu-checkbox" class="service-title">PROVIDE AN ACU</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="acu-comment">COMMENT</label>
                    <textarea id="acu-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 10 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-stepladder-checkbox" class="service-checkbox">
                <label for="departure-stepladder-checkbox" class="service-title">PROVIDE A STEPLADDER</label>
            </div>
            <div class="service-content">
                <div class="checkbox-group">
                    <input type="checkbox" id="departure-stepladder-above">
                    <label for="departure-stepladder-above">ABOVE 1.5 m.</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="stepladder-below">
                    <label for="stepladder-below">BELOW 1.5 m.</label>
                </div>
                <div class="form-group">
                    <label for="stepladder-comment">COMMENT</label>
                    <textarea id="stepladder-comment" placeholder="Additional information"></textarea>
                </div>
            </div>
        </div>

        <!-- Service 11 -->
        <div class="service-item">
            <div class="service-header">
                <input type="checkbox" id="departure-other-checkbox" class="service-checkbox">
                <label for="departure-other-checkbox" class="service-title">OTHER</label>
            </div>
            <div class="service-content">
                <div class="form-group">
                    <label for="other-comment">COMMENT</label>
                    <textarea id="other-comment" placeholder="Describe your request"></textarea>
                </div>
            </div>
        </div>
    </form>
    <button type="submit" class="submit-btn">SUBMIT ORDER</button>
    <div class="notification" id="notification"></div>

    <script src="../script.js"></script>

   <script>
     document.querySelectorAll('.service-header').forEach(header => {
    if (header) {
        header.addEventListener('click', function() {
            const content = this.nextElementSibling;
            const plusIcon = this.querySelector('.plus-icon');
            
            if (content) content.classList.toggle('active');
            if (plusIcon) plusIcon.classList.toggle('rotated');
        });
    }
    });
    // Универсальная функция для настройки сервисов
    function setupService(checkboxId) {
        const checkbox = document.getElementById(checkboxId);
        if (!checkbox) return;
        
        const content = checkbox.closest('.service-item').querySelector('.service-content');
        
        checkbox.addEventListener('change', function() {
            content.style.display = this.checked ? 'block' : 'none';
        });
        
        content.style.display = checkbox.checked ? 'block' : 'none';
    }

    function setupWaterService(prefix) {
        setupService(`${prefix}-water-checkbox`);
        
        const fillCheckbox = document.getElementById(`${prefix}-water-fill`);
        const quantityGroup = document.getElementById(`${prefix}-water-quantity-group`);
        
        if (fillCheckbox && quantityGroup) {
            fillCheckbox.addEventListener('change', function() {
                quantityGroup.style.display = this.checked ? 'block' : 'none';
                if (!this.checked) {
                    document.getElementById(`${prefix}-water-quantity`).value = '';
                }
            });
            quantityGroup.style.display = fillCheckbox.checked ? 'block' : 'none';
        }
    }

    function setupLavatoryService(prefix) {
        setupService(`${prefix}-lavatory-checkbox`);
        
        const fillCheckbox = document.getElementById(`${prefix}-lavatory-fill`);
        const quantityGroup = document.getElementById(`${prefix}-lavatory-quantity-group`);
        
        if (fillCheckbox && quantityGroup) {
            fillCheckbox.addEventListener('change', function() {
                quantityGroup.style.display = this.checked ? 'block' : 'none';
                if (!this.checked) {
                    document.getElementById(`${prefix}-lavatory-quantity`).value = '';
                }
            });
            quantityGroup.style.display = fillCheckbox.checked ? 'block' : 'none';
        }
    }

    function setupFileUpload(inputId, displayId) {
        const fileInput = document.getElementById(inputId);
        const fileNameDisplay = document.getElementById(displayId);
        
        if (fileInput && fileNameDisplay) {
            fileInput.addEventListener('change', function() {
                const files = this.files;
                fileNameDisplay.textContent = files.length === 0 ? 'No files selected' : 
                                           files.length === 1 ? files[0].name : 
                                           `${files.length} files selected`;
            });
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Настройка всех сервисов
        const services = [
            'arrival-fuel-checkbox', 'arrival-catering-checkbox', 'arrival-garbage-checkbox',
            'arrival-storage-checkbox', 'arrival-gpu-checkbox', 'arrival-acu-checkbox',
            'arrival-stepladder-checkbox', 'arrival-other-checkbox', 'arrival-documents-checkbox',
            'departure-fuel-checkbox', 'departure-catering-checkbox', 'departure-garbage-checkbox',
            'departure-storage-checkbox', 'departure-gpu-checkbox', 'departure-acu-checkbox',
            'departure-stepladder-checkbox', 'departure-other-checkbox', 'departure-documents-checkbox'
        ];
        
        services.forEach(serviceId => setupService(serviceId));
        
        setupLavatoryService('arrival');
        setupLavatoryService('departure');

        setupWaterService('arrival');
        setupWaterService('departure');
        
        setupFileUpload('arrival-document-files', 'arrival-document-files-name');
        setupFileUpload('departure-document-files', 'departure-document-files-name');

        // Обработка формы
        document.getElementById('servicesForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const notification = document.getElementById('notification');
        
        // Собираем данные пользователя
        const userData = JSON.parse(localStorage.getItem('userData')) || {};
        
        // Собираем данные формы только для выбранных сервисов
        const formData = {
            user: {
                name: userData.name || 'Not provided',
                phone: userData.phone || 'Not provided',
                flight: userData.flightNumber || 'Not provided'
            },
            arrivalServices: {},
            departureServices: {}
        };

        // Функция для сбора данных сервиса
       function collectServiceData(prefix, serviceName) {
    const checkbox = document.getElementById(`${prefix}-${serviceName}-checkbox`);
    if (checkbox && checkbox.checked) {
        const serviceData = {};
        const serviceItem = checkbox.closest('.service-item');
        
        if (!serviceItem) return null;
        
        // Собираем текстовые поля и textarea
        const inputs = serviceItem.querySelectorAll('input[type="text"], input[type="number"], textarea');
        inputs.forEach(input => {
            if (input.value) {
                serviceData[input.name || input.id] = input.value;
            }
        });
        
        // Собираем чекбоксы (только отмеченные)
        const checkboxes = serviceItem.querySelectorAll('input[type="checkbox"]:checked');
        checkboxes.forEach(checkbox => {
            serviceData[checkbox.name || checkbox.id] = true;
        });
        
        // Собираем информацию о файлах
        const fileInput = serviceItem.querySelector('input[type="file"]');
        if (fileInput && fileInput.files.length > 0) {
            serviceData.files = Array.from(fileInput.files).map(file => file.name).join(', ');
        }
        
        return serviceData;
    }
    return null;
}

        // Собираем сервисы прибытия
        const arrivalServices = [
            'fuel', 'water', 'lavatory', 'catering', 
            'garbage', 'documents', 'storage', 
            'gpu', 'acu', 'stepladder', 'other'
        ];
        
        arrivalServices.forEach(service => {
            const data = collectServiceData('arrival', service);
            if (data) formData.arrivalServices[service] = data;
        });

        // Собираем сервисы отправления
        const departureServices = [
            'fuel', 'water', 'lavatory', 'catering', 
            'garbage', 'documents', 'storage', 
            'gpu', 'acu', 'stepladder', 'other'
        ];
        
        departureServices.forEach(service => {
            const data = collectServiceData('departure', service);
            if (data) formData.departureServices[service] = data;
        });

        // Формируем содержимое письма
        let emailContent = `
            <h2>New Services Request</h2>
            <h3>User Information</h3>
            <p><strong>Name:</strong> ${formData.user.name}</p>
            <p><strong>Phone:</strong> ${formData.user.phone}</p>
            <p><strong>Tail Number:</strong> ${formData.user.flight}</p>
        `;

        // Добавляем сервисы прибытия
        if (Object.keys(formData.arrivalServices).length > 0) {
            emailContent += `<h3>Arrival Services</h3>`;
            for (const [service, data] of Object.entries(formData.arrivalServices)) {
                emailContent += `<h4>${service.toUpperCase()}</h4><ul>`;
                for (const [key, value] of Object.entries(data)) {
                    emailContent += `<li><strong>${key}:</strong> ${value}</li>`;
                }
                emailContent += `</ul>`;
            }
        }

        // Добавляем сервисы отправления
        if (Object.keys(formData.departureServices).length > 0) {
            emailContent += `<h3>Departure Services</h3>`;
            for (const [service, data] of Object.entries(formData.departureServices)) {
                emailContent += `<h4>${service.toUpperCase()}</h4><ul>`;
                for (const [key, value] of Object.entries(data)) {
                    emailContent += `<li><strong>${key}:</strong> ${value}</li>`;
                }
                emailContent += `</ul>`;
            }
        }

        // Параметры для EmailJS
        const templateParams = {
            user_name: formData.user.name,
            user_phone: formData.user.phone,
            user_flight: formData.user.flight,
            email_subject: `New Services Request from ${formData.user.name} (Flight: ${formData.user.flight})`,
            email_content: emailContent
        };

        // Отправка через EmailJS
        emailjs.send('service_els1igx', 'template_yzno5sp', templateParams)
            .then(() => {
                notification.textContent = 'Order submitted successfully! Email sent.';
                notification.className = 'notification success';
                notification.style.display = 'block';
                
                // Очистка формы
                this.reset();
                document.querySelectorAll('.service-content').forEach(el => {
                    el.style.display = 'none';
                });
                
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 5000);
            })
            .catch(error => {
                console.error('Email sending failed:', error);
                notification.textContent = 'Order submitted but email failed. Please contact support.';
                notification.className = 'notification error';
                notification.style.display = 'block';
            });
    });

        // Загрузка данных пользователя
        const savedData = localStorage.getItem('userData');
        if (savedData) {
            const userData = JSON.parse(savedData);
            document.getElementById('info-name').textContent = userData.name || 'Not provided';
            document.getElementById('info-phone').textContent = userData.phone || 'Not provided';
            document.getElementById('info-flight').textContent = userData.flightNumber || 'Not provided';
        } else {
            window.location.href = 'index.html';
        }
    });
</script>
</body>
</html>
